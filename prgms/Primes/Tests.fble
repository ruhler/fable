
% Unit = /Unit%.Unit;

% Chars = /Char%.Chars;

@ String@ = /String%.String@;
% Str = /String%.Str;

@ IntP@ = /Int/IntP%.IntP@;
% 1 = /Int/IntP%.1;
% 3 = /Int/IntP%.3;
% 10 = /Int/IntP%.10;
% Lit2 = /Int/IntP%.Lit2;

% Eq = /Int/IntP/Eq%.Eq;

@ IntS@ = /Int/IntS%.IntS@;

% NthPrime = /Primes%.NthPrime;

@ Test@ = /Test%.Test@;
@ TestResult@ = /Test%.TestResult@;
@ TestSuite@ = /Test%.TestSuite@;
% TestSuite = /Test%.TestSuite;

(String@, IntP@, IntP@){Test@;} TEq = (String@ name, IntP@ a, IntP@ b) {
  Test@(name, !({
    # TODO: Better error message in case of failure.
    Eq(a, b).?(
        true: TestResult@(pass: Unit),
        false: TestResult@(fail: Str(Chars|failed)));
  }));
};

Test@ NthPrime_1_10 = TEq(Str(Chars|'NthPrime_1_10'), Lit2(3, 1), NthPrime(1, IntS@(p: 10)));

TestSuite@ Tests = TestSuite(Chars|Primes, [NthPrime_1_10]);

@(Tests);
