{ /Unit%; @(Unit@, Unit); };
{ /Bool%; @(Bool@); };
{ /Char%; @(Char@, Chars); };
{ /List%; @(S@, P@, ConsS, S, Append, Concat); };
{ /String%; @(Str@, Str); };
{ /Int/IntP%; @(IntP@, 1, 3, 10, Lit2); };
{ /Int/IntP/Eq%; @(Eq); };
{ /Int/IntS%; @(IntS@); };
{ /Primes%; @(NthPrime); };
{ /Test%; @(TestResult@, Test@); };

(Str@, IntP@, IntP@){Test@;} TEq = (Str@ name, IntP@ a, IntP@ b) {
  Test@(Append<Char@>(Str(Chars|'Primes.'), name), $({
    # TODO: Better error message in case of failure.
    ?(Eq(a, b);
        true: TestResult@(pass: Unit),
        false: TestResult@(fail: Str(Chars|failed)));
  }));
};

Test@ NthPrime_1_10 = TEq(Str(Chars|'NthPrime_1_10'), Lit2(3, 1), NthPrime(1, IntS@(p: 10)));

S@<Test@> Tests = S<Test@>([NthPrime_1_10]);

@(Tests);
