
rule cc
  deps = gcc
  depfile = $out.d
  command = g++ -I . -MMD -MF $out.d -O0 -gdwarf-3 -ggdb -std=c++11 -c -o $out $in

rule ld
  command = g++ -O0 -gdwarf-3 -ggdb -std=c++11 -o $out $in -lgtest -lgtest_main -lpthread

rule run
  command = $in && touch $out

rule tclsh
  command = tclsh $in > $out

build build/error.o: cc error.cc
build build/test: ld build/foo.o
build build/test_passed: run build/test

