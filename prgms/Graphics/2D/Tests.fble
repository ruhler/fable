
@ Drawing@ = /Drawing%.Drawing@;
@ Point@ = /Drawing%.Point@;
% Color = /Drawing%.Color;

@ Drawn@ = /Drawing/Test%.Drawn@;
@ Pixel@ = /Drawing/Test%.Pixel@;
% Drawn = /Drawing/Test%.Drawn;
% Draw = /Drawing/Test%.Draw;

% Triangle = /Graphics/2D%.Triangle;

% Int = /Int/Int/Lit%.Int;

<@>% List = /List%.List;

% Str = /String%.Str;

@ Test@ = /Test%.Test@;
% Test = /Test%.Test;
% TestSuite = /Test%.TestSuite;

Test@ Tests = TestSuite(Str|'Graphics.2D', List<Test@>[
  Test(Str|'Lower Left Right Triangle', !({
    Drawing@ drawing = Triangle(
      Point@(Int|0, Int|0),
      Point@(Int|0, Int|3),
      Point@(Int|3, Int|0), Color.Green);

    Drawn@ wnt = Drawn[
      Pixel@(Int|0, Int|0, Color.Green),
      Pixel@(Int|0, Int|1, Color.Green),
      Pixel@(Int|0, Int|2, Color.Green),
      Pixel@(Int|1, Int|0, Color.Green),
      Pixel@(Int|1, Int|1, Color.Green),
      Pixel@(Int|2, Int|0, Color.Green)
    ];
    Drawn@ got = Draw(drawing);
      
    /Drawing/Test%.AssertEquals(wnt, got);
  })),

  Test(Str|'Upper Left Right Triangle', !({
    Drawing@ drawing = Triangle(
      Point@(Int|0, Int|0),
      Point@(Int|0, Int|3),
      Point@(Int|3, Int|3), Color.Green);

    Drawn@ wnt = Drawn[
      Pixel@(Int|0, Int|0, Color.Green),
      Pixel@(Int|0, Int|1, Color.Green),
      Pixel@(Int|0, Int|2, Color.Green),
      Pixel@(Int|1, Int|1, Color.Green),
      Pixel@(Int|1, Int|2, Color.Green),
      Pixel@(Int|2, Int|2, Color.Green)
    ];
    Drawn@ got = Draw(drawing);
      
    # TODO: Figure out whether we should draw pixels on the diagonal or not.
    /Test%.ExpectFails(/Drawing/Test%.AssertEquals(wnt, got), Str|'');
  })),

  Test(Str|'Upper Right Right Triangle', !({
    Drawing@ drawing = Triangle(
      Point@(Int|0, Int|3),
      Point@(Int|3, Int|3),
      Point@(Int|3, Int|0), Color.Green);

    Drawn@ wnt = Drawn[
      Pixel@(Int|0, Int|2, Color.Green),
      Pixel@(Int|1, Int|1, Color.Green),
      Pixel@(Int|1, Int|2, Color.Green),
      Pixel@(Int|2, Int|0, Color.Green),
      Pixel@(Int|2, Int|1, Color.Green),
      Pixel@(Int|2, Int|2, Color.Green)
    ];
    Drawn@ got = Draw(drawing);
      
    # TODO: Figure out whether we should draw pixels on the diagonal or not.
    /Test%.ExpectFails(/Drawing/Test%.AssertEquals(wnt, got), Str|'');
  })),

  Test(Str|'Lower Right Right Triangle', !({
    Drawing@ drawing = Triangle(
      Point@(Int|0, Int|0),
      Point@(Int|3, Int|3),
      Point@(Int|3, Int|0), Color.Green);

    Drawn@ wnt = Drawn[
      Pixel@(Int|0, Int|0, Color.Green),
      Pixel@(Int|1, Int|0, Color.Green),
      Pixel@(Int|1, Int|1, Color.Green),
      Pixel@(Int|2, Int|0, Color.Green),
      Pixel@(Int|2, Int|1, Color.Green),
      Pixel@(Int|2, Int|2, Color.Green)
    ];
    Drawn@ got = Draw(drawing);
      
    /Drawing/Test%.AssertEquals(wnt, got);
  })),

  Test(Str|'Counter Clockwise', !({
    Drawing@ drawing = Triangle(
      Point@(Int|0, Int|0),
      Point@(Int|3, Int|0),
      Point@(Int|0, Int|3), Color.Green);

    # A counter clockwise triangle doesn't get drawn.
    Drawn@ wnt = Drawn[];
    Drawn@ got = Draw(drawing);
      
    /Drawing/Test%.AssertEquals(wnt, got);
  }))
]);

@(Tests);
