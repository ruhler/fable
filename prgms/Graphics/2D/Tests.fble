
@ Drawing@ = /Drawing%.Drawing@;
@ Point@ = /Drawing%.Point@;
% Color = /Drawing%.Color;

@ Drawn@ = /Drawing/Test%.Drawn@;
@ Pixel@ = /Drawing/Test%.Pixel@;
% Drawn = /Drawing/Test%.Drawn;
% Draw = /Drawing/Test%.Draw;

% Point = /Graphics/2D%.Point;
% Line = /Graphics/2D%.Line;

% Int = /Int/Int/Lit%.Int;
% Neg = /Int/Int%.Neg;

<@>% List = /List%.List;

% Str = /String%.Str;

@ Test@ = /Test%.Test@;
% Test = /Test%.Test;
% TestSuite = /Test%.TestSuite;

Test@ Tests = TestSuite(Str|'Graphics.2D', List<Test@>[
  Test(Str|'Point', !({
    Drawing@ drawing = Point(Point@(Int|2, Int|5), Color.Green);
    Drawn@ wnt = Drawn[Pixel@(Int|2, Int|5, Color.Green)];
    Drawn@ got = Draw(drawing);
      
    /Drawing/Test%.AssertEquals(wnt, got);
  })),

  Test(Str|'NegativePoint', !({
    Drawing@ drawing = Point(Point@(Neg(Int|2), Neg(Int|5)), Color.Green);
    Drawn@ wnt = Drawn[Pixel@(Neg(Int|2), Neg(Int|5), Color.Green)];
    Drawn@ got = Draw(drawing);

    /Drawing/Test%.AssertEquals(wnt, got);
  })),

  Test(Str|'HorizontalLine', !({
    Drawing@ drawing = Line(
      Point@(Int|2, Int|3),
      Point@(Int|4, Int|3), Color.Green);

    Drawn@ wnt = Drawn[
      Pixel@(Int|2, Int|3, Color.Green),
      Pixel@(Int|3, Int|3, Color.Green),
      Pixel@(Int|4, Int|3, Color.Green)
    ];
    Drawn@ got = Draw(drawing);
      
    /Drawing/Test%.AssertEquals(wnt, got);
  })),

  Test(Str|'VerticalLine', !({
    Drawing@ drawing = Line(
      Point@(Int|2, Int|3),
      Point@(Int|2, Int|5), Color.Green);

    Drawn@ wnt = Drawn[
      Pixel@(Int|2, Int|3, Color.Green),
      Pixel@(Int|2, Int|4, Color.Green),
      Pixel@(Int|2, Int|5, Color.Green)
    ];
    Drawn@ got = Draw(drawing);
      
    /Drawing/Test%.AssertEquals(wnt, got);
  })),

  Test(Str|'DiagonalLine', !({
    Drawing@ drawing = Line(
      Point@(Int|2, Int|3),
      Point@(Int|4, Int|5), Color.Green);

    Drawn@ wnt = Drawn[
      Pixel@(Int|2, Int|3, Color.Green),
      Pixel@(Int|3, Int|4, Color.Green),
      Pixel@(Int|4, Int|5, Color.Green)
    ];
    Drawn@ got = Draw(drawing);
      
    /Drawing/Test%.AssertEquals(wnt, got);
  })),

  Test(Str|'ReverseDiagonalLine', !({
    Drawing@ drawing = Line(
      Point@(Int|4, Int|5),
      Point@(Int|2, Int|3), Color.Green);

    Drawn@ wnt = Drawn[
      Pixel@(Int|2, Int|3, Color.Green),
      Pixel@(Int|3, Int|4, Color.Green),
      Pixel@(Int|4, Int|5, Color.Green)
    ];
    Drawn@ got = Draw(drawing);
      
    # TODO: Fix this.
    # The trouble is:
    #  The point (0, 0) is represented as rect (0, 0, 1, 1).
    #  Negate:  -(0, 0) represented as -(0, 0, 1, 1),
    #            (0, 0) represented as (0, 0, -1, -1)
    #                   represented as (-1, -1, 1, 1)
    #  So, somehow we turned (0, 0) into (-1, -1).
    /Test%.ExpectFails(/Drawing/Test%.AssertEquals(wnt, got), Str|'(1, 2)');
  }))
]);

@(Tests);
